<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=5" />
  <title>Oradia – Tirage du Tore</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'night-blue': '#0a192f',
            'gold': '#d4af37',
            'light-gold': '#f5e7a1',
            'dark-blue': '#051428',
            'celtic-blue': '#1a365d'
          },
          fontFamily: {
            'cormorant': ['Cormorant Garamond', 'serif'],
            'poppins': ['Poppins', 'sans-serif']
          }
        }
      }
    }
  </script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600;700&family=Poppins:wght@300;400;500;600&display=swap');

    :root {
      --dore:#d4af37;
      --text:#e9e7df;
    }

    body {
      margin:0;
      font-family:'Poppins',sans-serif;
      background:#0a192f;
      color:#f5e7a1;
    }

    .cormorant { font-family:'Cormorant Garamond', serif; }
    .bg-night-blue { background-color:#0a192f; }
    .text-gold { color:#d4af37; }
    .text-light-gold { color:#f5e7a1; }

    .btn-gold {
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding:0.75rem 1.5rem;
      border-radius:9999px;
      background:linear-gradient(90deg,#d4af37,#f5e7a1,#d4af37);
      background-size:200% 200%;
      color:#051428;
      font-weight:600;
      font-size:0.95rem;
      box-shadow:0 10px 30px rgba(0,0,0,.45);
      border:none;
      cursor:pointer;
      transition:transform .2s, box-shadow .2s, background-position .4s;
      text-decoration:none;
    }
    .btn-gold:hover {
      transform:translateY(-1px);
      box-shadow:0 15px 40px rgba(0,0,0,.6);
      background-position:100% 0;
    }

    .gold-gradient {
      background:linear-gradient(90deg,#d4af37,#f5e7a1,#d4af37);
      -webkit-background-clip:text;
      background-clip:text;
      color:transparent;
    }

    .container {
      max-width:1200px;
      margin:0 auto;
    }
  </style>
</head>
<body class="bg-night-blue text-light-gold">
<header class="bg-[rgba(5,20,40,0.8)] py-4 shadow-lg backdrop-blur-lg border-b border-gold/20">
  <div class="container mx-auto flex items-center justify-between px-4 md:px-6">

    <!-- LOGO -->
    <a href="index.html#accueil" class="flex items-center gap-4">
      <img src="https://i.ibb.co/Q3vbXP4S/logo.png" alt="Oradia Logo"
           class="w-16 h-16 transform hover:scale-110 transition-transform duration-300" />
      <span class="cormorant text-3xl font-bold gold-gradient">ORADIA</span>
    </a>

    <!-- NAVIGATION -->
    <nav class="hidden md:flex items-center space-x-8 text-gold font-medium">
      <a href="index.html#accueil" class="hover:text-light-gold transition">
        <i class="fas fa-home mr-2"></i>Accueil
      </a>
      <a href="index.html#offres" class="hover:text-light-gold transition">
        <i class="fas fa-tags mr-2"></i>Offres
      </a>
      <a href="index.html#Jeu" class="hover:text-light-gold transition">
        <i class="fas fa-dice mr-2"></i>Jeu
      </a>
      <a href="index.html#edolgor" class="hover:text-light-gold transition">
        <i class="fas fa-handshake mr-2"></i>Partenariat
      </a>
      <a href="index.html#apropos" class="hover:text-light-gold transition">
        <i class="fas fa-info-circle mr-2"></i>À Propos
      </a>
    </nav>

    <!-- ESPACE MEMBRE -->
    <div id="memberMenuWrapper" class="hidden md:block relative">
      <button id="memberMenuBtn" class="flex items-center gap-2 text-gold font-medium hover:text-light-gold transition">
        <i class="fas fa-user-circle text-2xl"></i>
        <span>Espace membre</span>
        <i class="fas fa-chevron-down text-sm ml-1"></i>
      </button>

      <div id="memberDropdown"
           class="hidden absolute right-0 mt-2 w-48 bg-[rgba(5,20,40,0.95)] border border-gold/30 rounded-lg shadow-lg z-50 backdrop-blur-md">
        <a href="profil.html" class="block px-4 py-2 text-gold hover:bg-gold/10">Profil</a>
        <a href="dashboard.html" class="block px-4 py-2 text-gold hover:bg-gold/10">Tableau de bord</a>
        <button id="logoutBtn" class="w-full text-left px-4 py-2 text-gold hover:bg-gold/10">Déconnexion</button>
      </div>
    </div>

    <!-- MENU MOBILE -->
    <button id="mobileMenuBtn" class="md:hidden text-gold text-3xl focus:outline-none">
      <i class="fas fa-bars"></i>
    </button>
  </div>

  <div id="mobileMenu"
       class="hidden flex-col items-center md:hidden bg-[rgba(5,20,40,0.95)] border-t border-gold/20 py-6 space-y-4 text-gold font-medium">
    <a href="index.html#accueil" class="hover:text-light-gold transition">Accueil</a>
    <a href="index.html#offres" class="hover:text-light-gold transition">Offres</a>
    <a href="index.html#Jeu" class="hover:text-light-gold transition">Jeu</a>
    <a href="index.html#edolgor" class="hover:text-light-gold transition">Partenariat</a>
    <a href="index.html#apropos" class="hover:text-light-gold transition">À Propos</a>
  </div>
</header>


<!-- ================== TIRAGE DU TORE – PAGE IMMERSIVE ================== -->

<style>
  /* Mode immersif : on cache le reste quand le tirage est lancé */
  body.hide-immersive-tore > header,
  body.hide-immersive-tore > footer,
  body.hide-immersive-tore > section:not(#tore-immersif) {
    display: none !important;
  }

  /* Plateau 7 tas façon photo "Six-Points" */
  #tore-immersif .tore-board-7 {
    display: grid;
    grid-template-columns: repeat(3, minmax(0,1fr));
    grid-template-rows: repeat(3, auto);
    gap: 16px;
    place-items: center;
    max-width: 1200px;
    margin: 0 auto;
  }

  /* Disposition des piles :
     Ligne 1 : Révélation (gauche)          [pos-5]
               (rien au centre)
               Action (droite)             [pos-3]
     Ligne 2 : Transmutation (gauche)      [pos-2]
               Mémoire Cosmos (centre)     [pos-6]
               Archétype (droite)          [pos-4]
     Ligne 3 : Émotions (gauche)           [pos-0]
               (rien au centre)
               Besoin (droite)             [pos-1]
  */
  #tore-immersif .tore-board-7 .pos-5 { grid-area: 1 / 1; }
  #tore-immersif .tore-board-7 .pos-3 { grid-area: 1 / 3; }

  #tore-immersif .tore-board-7 .pos-2 { grid-area: 2 / 1; }
  #tore-immersif .tore-board-7 .pos-6 { grid-area: 2 / 2; }
  #tore-immersif .tore-board-7 .pos-4 { grid-area: 2 / 3; }

  #tore-immersif .tore-board-7 .pos-0 { grid-area: 3 / 1; }
  #tore-immersif .tore-board-7 .pos-1 { grid-area: 3 / 3; }

  /* Cartes du TORE  */
  .tore-card {
    width: min(260px, 80vw);
    height: 380px;
    perspective: 1000px;
    position: relative;
  }

  @media (max-width: 860px) {
    #tore-immersif .tore-board-7 {
      grid-template-columns: 1fr;
      grid-template-rows: auto;
    }
    #tore-immersif .tore-board-7 .pos-0,
    #tore-immersif .tore-board-7 .pos-1,
    #tore-immersif .tore-board-7 .pos-2,
    #tore-immersif .tore-board-7 .pos-3,
    #tore-immersif .tore-board-7 .pos-4,
    #tore-immersif .tore-board-7 .pos-5,
    #tore-immersif .tore-board-7 .pos-6 {
      grid-area: auto;
    }
  }
  .tore-card-inner {
    position: relative;
    width: 100%;
    height: 100%;
    transform-style: preserve-3d;
    transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    border-radius: 18px;
    box-shadow: 0 20px 40px rgba(0,0,0,45);
  }
  .tore-card.flipped .tore-card-inner {
    transform: rotateY(180deg);
  }
.tore-card-back,
  .tore-card-front {
    position: absolute;
    inset: 0;
    backface-visibility: hidden;
    border-radius: 18px;
    overflow: hidden;
    border: 1px solid rgba(212,175,55,45);
  }

  .tore-card-back {
    background: radial-gradient(circle at 20% 0%, rgba(245,231,161,15), transparent 55%),
                radial-gradient(circle at 80% 100%, rgba(88,190,255,12), transparent 55%),
                linear-gradient(160deg,#050b18,#08152b,#050b18);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
  }
  .tore-card-back .logo-circle {
    border-radius: 999px;
    padding: 10px 24px;
    border: 1px solid rgba(212,175,55,6);
    color: #f5e7a1;
    letter-spacing: .18em;
    text-transform: uppercase;
    font-size: .8rem;
  }

  .tore-card-front {
    transform: rotateY(180deg);
    background: radial-gradient(circle at 20% 0%, rgba(245,231,161,15), transparent 55%),
                radial-gradient(circle at 80% 100%, rgba(88,190,255,12), transparent 55%),
                linear-gradient(160deg,#071426,#020814,#050b18);
    display: flex;
    flex-direction: column;
    padding: 16px 18px;
    color: #f9f7ef;
  }
  .tore-card-front .topbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: .8rem;
    margin-bottom: 12px;
  }
  .tore-card-front .chip {
    border-radius: 999px;
    border: 1px solid rgba(212,175,55,75);
    padding: 4px 10px;
    text-transform: uppercase;
    font-weight: 600;
    letter-spacing: .14em;
    font-size: .72rem;
  }
  .tore-card-front .polarity {
    font-size: 1.1rem;
  }
  .tore-card-front .art {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    padding: 0 6px;
  }
  .tore-card-front [data-name] {
    font-family: "Cormorant Garamond", serif;
    font-size: 1.6rem;
    margin-bottom: .3rem;
  }
  .tore-card-front [data-quote] {
    font-size: .93rem;
    line-height: 1.4;
    opacity: .9;
  }
</style>

<section id="tore-immersif" class="py-20 px-6 bg-night-blue">
  <div class="container mx-auto max-w-6xl">
    <div class="text-center mb-12">
      <h1 class="cormorant text-4xl md:text-5xl font-bold mb-4 gold-gradient pb-1">
        Tirage du TORE
      </h1>
      <p class="text-light-gold max-w-3xl mx-auto">
        Guidance vibratoire complète.
      </p>
    </div>

    <div class="rounded-2xl p-8 mb-8 relative overflow-hidden"
         style="background:linear-gradient(145deg,rgba(26,54,93,.8),rgba(5,20,40,.9));border:1px solid rgba(212,175,55,.3)">

      <!-- Bouton retour mode immersif -->
      <button id="exitToreBtn"
              class="fixed top-4 left-4 hidden z-50 bg-gold text-night-blue font-bold px-4 py-2 rounded-lg shadow-lg">
        <i class="fas fa-arrow-left mr-2"></i>Quitter le tirage
      </button>

      <!-- INTRO -->
        <div id="tore-intro" class="relative z-10 text-center flex flex-col items-center">
        <h2 class="cormorant text-2xl text-gold mb-4">Préparation du tirage du TORE</h2>
        <p class="text-light-gold mb-6 max-w-2xl mx-auto">
          Nous avons besoin de quelques informations pour calibrer l’expérience.
        </p>
        <button id="tore-start" class="btn-gold mt-4">Commencer le tirage</button>
      </div>

      <!-- FORMULAIRE AVANT LE PLATEAU -->
      <form id="tore-form" class="hidden relative z-10 mt-6">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
          <div>
            <label class="block text-light-gold mb-2">Prénoms</label>
            <input type="text" name="prenom"
                   class="w-full bg-[rgba(5,20,40,7)] border border-[rgba(212,175,55,35)] p-3 rounded-lg"
                   required>
          </div>
          <div>
            <label class="block text-light-gold mb-2">Date de naissance</label>
            <input type="date" name="date"
                   class="w-full bg-[rgba(5,20,40,7)] border border-[rgba(212,175,55,35)] p-3 rounded-lg"
                   required>
          </div>
          <div>
            <label class="block text-light-gold mb-2">Ville de naissance</label>
            <input type="text" name="ville"
                   class="w-full bg-[rgba(5,20,40,7)] border border-[rgba(212,175,55,35)] p-3 rounded-lg"
                   required>
          </div>
          <div>
            <label class="block text-light-gold mb-2">Heure de naissance</label>
            <input type="time" name="heure"
                   class="w-full bg-[rgba(5,20,40,7)] border border-[rgba(212,175,55,35)] p-3 rounded-lg"
                   required>
          </div>
        </div>
        <div class="mb-6">
          <label class="block text-light-gold mb-2">Votre intention pour ce tirage complet</label>
          <textarea name="intention"
                    class="w-full bg-[rgba(5,20,40,7)] border border-[rgba(212,175,55,35)] p-3 rounded-lg min-h-[120px]"
                    required></textarea>
        </div>
        <button type="submit" class="btn-gold w-full">Lancer le tirage du TORE</button>
      </form>

      <!-- PLATEAU – 7 TAS EN MODE SIX-POINTS -->
      <div id="tore-board" class="hidden relative z-10 mt-10">
        <h3 class="cormorant text-2xl text-gold mb-6 text-center">
          Retournez les 7 cartes du Tore
        </h3>
        <div class="tore-board-7">
          <!-- Les cartes sont générées par le script ci-dessous -->
        </div>
      </div>

      <!-- RÉSULTATS TEXTE -->
      <div id="tore-results" class="hidden relative z-10 mt-10">
        <!-- DeepSite peut injecter ici le rendu détaillé (texte, synthèse, etc.) -->
      </div>
    </div>
  </div>
</section>
<script>
// --------- Données cartes ----------
window.DATA = {

  // ▲ = yang (triangle) • ● = yin (cercle)

  emotions: [
    {name:"JOIE",           quote:"L’onde éclate, la lumière danse dans ton cœur.", polarity:"yang"},
    {name:"TRISTESSE",      quote:"La pluie descend, lavant la mémoire des pierres.", polarity:"yin"},
    {name:"AMOUR",          quote:"Le souffle relie, un fil invisible circule.", polarity:"yang"},
    {name:"SOLITUDE",       quote:"Le silence s’installe comme une montagne.", polarity:"yin"},
    {name:"ÉMERVEILLEMENT", quote:"L’enfant intérieur ouvre grand ses yeux.", polarity:"yang"},
    {name:"DÉGOÛT",         quote:"Le corps rejette ce qui empoisonne.", polarity:"yin"},
    {name:"SÉRÉNITÉ",       quote:"Le lac reflète le ciel, sans trouble.", polarity:"yang"},
    {name:"DOUTE",          quote:"La brume recouvre la vallée.", bridge:"Habiter la question en attendant la clarté.", polarity:"yin"},
    {name:"COLÈRE",         quote:"Le feu jaillit, brisant les chaînes.", polarity:"yang"},
    {name:"INJUSTICE",      quote:"La balance penche, l’équité s’efface.", polarity:"yin"},
    {name:"COURAGE",        quote:"Le pas tremblant franchit la ligne.", polarity:"yang"},
    {name:"PEUR",           quote:"L’animal se fige aux lisières.", polarity:"yin"},
    {name:"CONFIANCE",      quote:"L’arbre se dresse, enraciné vers la lumière.", polarity:"yang"},
    {name:"HONTE",          quote:"Le visage se cache sous le voile.", polarity:"yin"},
    {name:"FIERTÉ",         quote:"La pierre sculptée témoigne du chemin.", polarity:"yang"},
    {name:"CULPABILITÉ",    quote:"Les chaînes invisibles pèsent au cœur.", bridge:"Rendre ce qui n’est pas sien et s’alléger.", polarity:"yin"},
    {name:"IMPATIENCE",     quote:"Le cheval piaffe avant l’aube.", polarity:"yang"},
    {name:"PATIENCE",       quote:"Le fruit mûrit dans l’ombre.", polarity:"yin"},
  ],

  besoins: [
    {name:"RECONNAISSANCE", quote:"Le bourgeon éclot quand il est vu.", polarity:"yang"},
    {name:"SÉCURITÉ",       quote:"Le foyer s’allume, le feu crépite.", polarity:"yin"},
    {name:"LIBERTÉ",        quote:"Le vent brise les clôtures invisibles.", polarity:"yang"},
    {name:"SOUTIEN",        quote:"Deux troncs s’appuient et forment un arc.", polarity:"yin"},
    {name:"REPOS",          quote:"Le corps se dépose, la rivière s’apaise.", polarity:"yin"},
    {name:"CLAIRETÉ",       quote:"Le soleil perce la brume.", polarity:"yang"},
    {name:"APPARTENANCE",   quote:"Le cercle s’ouvre pour accueillir.", polarity:"yin"},
    {name:"AUTONOMIE",      quote:"La tige se redresse seule.", polarity:"yang"},
    {name:"STIMULATION",    quote:"L’étincelle jaillit et anime la marche.", polarity:"yang"},
    {name:"HARMONIE",       quote:"La lyre vibre de cordes accordées.", polarity:"yin"},
    {name:"AMOUR REÇU",     quote:"Le cœur s’ouvre comme une coupe.", polarity:"yang"},
    {name:"SENS",           quote:"La marche trace un sillon vers le tout.", polarity:"yin"},
    {name:"PROTECTION",     quote:"Le manteau couvre de chaleur.", polarity:"yin"},
    {name:"EXPANSION",      quote:"L’horizon s’élargit et appelle.", polarity:"yang"},
    {name:"INTIMITÉ",       quote:"L’alcôve garde le secret des âmes.", polarity:"yin"},
    {name:"CRÉATIVITÉ",     quote:"L’étincelle façonne une forme neuve.", polarity:"yang"},
    {name:"VÉRITÉ",         quote:"Le miroir reflète sans détour.", polarity:"yin"},
    {name:"GUIDANCE",       quote:"L’étoile brille au-dessus du chemin.", polarity:"yang"},
  ],

  transmutation: [
    {name:"ACCEPTATION",   quote:"La pierre immobile se laisse sculpter par la rivière.", polarity:"yin"},
    {name:"TRANSFORMATION",quote:"Le feu consume et révèle la braise d’or.", polarity:"yang"},
    {name:"LÂCHER-PRISE",  quote:"La feuille tombe et nourrit la terre.", polarity:"yin"},
    {name:"RECADRAGE",     quote:"Le miroir change d’angle et tout se déplace.", polarity:"yang"},
    {name:"PARDON",        quote:"Les chaînes brisées rouillent au sol.", polarity:"yin"},
    {name:"ALIGNEMENT",    quote:"Les astres s’ordonnent sur un axe commun.", polarity:"yang"},
    {name:"DÉTACHEMENT",   quote:"L’oiseau s’élève sans s’accrocher aux branches.", polarity:"yin"},
    {name:"PURIFICATION",  quote:"L’eau claire traverse la roche.", polarity:"yang"},
    {name:"ANCRAGE",       quote:"Les racines plongent dans le sol fertile.", polarity:"yin"},
    {name:"OUVERTURE",     quote:"La porte s’entrouvre, la lumière jaillit.", polarity:"yang"},
    {name:"FLUIDITÉ",      quote:"La rivière contourne l’obstacle sans effort.", polarity:"yin"},
    {name:"CLARIFICATION", quote:"La brume se lève, les contours se révèlent.", polarity:"yang"},
    {name:"SILENCE",       quote:"Le vide sonore abrite l’invisible.", polarity:"yin"},
    {name:"EXPRESSION",    quote:"La parole jaillit comme source claire.", polarity:"yang"},
    {name:"VIDE",          quote:"La coupe vide attend d’être remplie.", polarity:"yin"},
    {name:"PLÉNITUDE",     quote:"Le vase déborde de miel et d’offrandes.", polarity:"yang"},
    {name:"INCARNATION",   quote:"Le pas touche la terre lourde.", polarity:"yin"},
    {name:"TRANSCENDANCE", quote:"L’aigle s’élève au-delà des nuées.", polarity:"yang"},
  ],

  archetypes: [
    {name:"MERLIN",         quote:"Le vieil arbre garde les secrets des âges.", polarity:"yin"},
    {name:"DRAGON ROUGE",   quote:"Le souffle ardent défend la vie.", polarity:"yang"},
    {name:"DRAGON BLANC",   quote:"Le gardien veille au seuil des mystères.", polarity:"yang"},
    {name:"LA CUVE",        quote:"Le creuset accueille le feu caché.", polarity:"yin"},
    {name:"SAINT-MICHEL",   quote:"L’épée fend le voile de l’illusion.", polarity:"yang"},
    {name:"LA COLLINE",     quote:"Du sommet, l’horizon se déploie.", polarity:"yin"},
    {name:"LE SAGE",        quote:"Le silence enseigne plus que mille mots.", polarity:"yin"},
    {name:"LE GUERRIER",    quote:"Le cœur frappe avec droiture.", polarity:"yang"},
    {name:"L’ALCHIMISTE",   quote:"Le plomb rêve de devenir or.", polarity:"yin"},
    {name:"LE BÂTISSEUR",   quote:"La pierre dressée trace l’ordre.", polarity:"yang"},
    {name:"LA PRÊTRESSE",   quote:"Le voile garde l’accès au mystère.", polarity:"yin"},
    {name:"LE VOYAGEUR",    quote:"Le pas ouvre la route inconnue.", polarity:"yang"},
    {name:"NOMADE",         quote:"Le pas sans fin cherche l’horizon.", polarity:"yang"},
    {name:"MATRICE",        quote:"Le ventre secret abrite le monde.", polarity:"yin"},
    {name:"RÊVEUR",         quote:"L’œil fermé voit d’autres mondes.", polarity:"yin"},
    {name:"VISIONNAIRE",    quote:"Le regard perce les âges à venir.", polarity:"yang"},
    {name:"GARDIEN DU FEU", quote:"La flamme veille au centre de la nuit.", polarity:"yang"},
    {name:"TISSEUSE",       quote:"Le fil relie les morceaux épars.", polarity:"yin"},
  ],

  revelations: [
    {name:"CLÉ",          quote:"L’objet caché ouvre la chambre secrète.", polarity:"yang"},
    {name:"PORTE",        quote:"L’ouverture se dessine dans le mur.", polarity:"yin"},
    {name:"MESSAGE",      quote:"Le souffle apporte un signe audible.", polarity:"yang"},
    {name:"SYNCHRONICITÉ",quote:"Les fils invisibles se répondent.", polarity:"yin"},
    {name:"SIGNE",        quote:"Un éclat discret scintille sur le chemin.", polarity:"yin"},
    {name:"VISION",       quote:"L’œil perce au-delà des voiles.", polarity:"yang"},
    {name:"PRÉSAGE",      quote:"Un souffle d’avenir traverse le présent.", polarity:"yin"},
    {name:"ÉVEIL",        quote:"L’esprit se souvient de lui-même.", polarity:"yang"},
    {name:"LUMIÈRE",      quote:"Un rayon fend l’ombre.", polarity:"yang"},
    {name:"DÉVOILEMENT",  quote:"Le rideau s’écarte, la scène surgit.", polarity:"yin"},
    {name:"VÉRITÉ",       quote:"Le voile tombe, l’essence apparaît.", polarity:"yang"},
    {name:"ILLUSION",     quote:"L’image trompe et captive.", polarity:"yin"},
    {name:"ÉTINCELLE",    quote:"Le feu naît d’une poussière de pierre.", polarity:"yang"},
    {name:"SILENCE",      quote:"L’absence de bruit révèle l’essentiel.", polarity:"yin"},
    {name:"CHIFFRE",      quote:"Le nombre ordonne l’univers caché.", polarity:"yang"},
    {name:"SYMBOLE",      quote:"L’image muette parle au cœur.", polarity:"yin"},
    {name:"ORIGINE",      quote:"La source coule en amont de tout.", polarity:"yin"},
    {name:"DESTIN",       quote:"La flèche vole vers son but.", polarity:"yang"},
  ],

  actions: [
    {name:"AGIR",        quote:"La graine pousse en sortant de terre.", polarity:"yang"},
    {name:"ÉCOUTER",     quote:"L’oreille se penche sur le murmure.", polarity:"yin"},
    {name:"DIRE",        quote:"La parole tranche comme un souffle clair.", polarity:"yang"},
    {name:"RECEVOIR",    quote:"Le cœur ouvert accueille le don.", polarity:"yin"},
    {name:"CRÉER",       quote:"Le geste façonne ce qui n’était pas.", polarity:"yang"},
    {name:"ACCUEILLIR",  quote:"La porte s’ouvre à l’inattendu.", polarity:"yin"},
    {name:"PARTAGER",    quote:"La coupe passe de main en main.", polarity:"yang"},
    {name:"PROTÉGER",    quote:"L’abri se dresse autour du fragile.", polarity:"yin"},
    {name:"ALLER VERS",  quote:"Le pas cherche la rencontre.", polarity:"yang"},
    {name:"SE RETIRER",  quote:"Le sage quitte la foule.", polarity:"yin"},
    {name:"CHOISIR",     quote:"Le carrefour appelle la décision.", polarity:"yang"},
    {name:"PATIENTER",   quote:"Le fruit mûrit lentement.", polarity:"yin"},
    {name:"PROCLAMER",   quote:"La voix s’élève dans l’assemblée.", polarity:"yang"},
    {name:"OBSERVER",    quote:"L’œil contemple sans agir.", polarity:"yin"},
    {name:"ORDONNER",    quote:"La main trace l’alignement des pierres.", polarity:"yang"},
    {name:"RÉCONCILIER", quote:"Les mains se rejoignent après la discorde.", polarity:"yin"},
    {name:"MANIFESTER",  quote:"La parole devient chair.", polarity:"yang"},
    {name:"ARRÊTER",     quote:"Le pas s’interrompt, la poussière retombe.", polarity:"yin"},
  ],

  cosmos: [
    {name:"ÉTOILE",              quote:"La voûte céleste inscrit la mémoire des mondes. Derrière leur éclat se cache la mémoire de l’infini."},
    {name:"TERRE",               quote:"Le sol garde les pas de ceux qui ont marché avant. Chaque pierre est une archive que ton corps sait lire."},
    {name:"OCÉAN",               quote:"Les vagues effacent et recommencent sans fin. Les profondeurs retiennent ce que la surface oublie."},
    {name:"GÉNÉALOGIE",          quote:"Tes racines prolongent des vies invisibles. Tu es à la fois héritage et commencement."},
    {name:"FUTUR",               quote:"La graine porte déjà l’ombre de la forêt. Chaque geste d’aujourd’hui écrit une prophétie."},
    {name:"PASSÉ",               quote:"Les échos d’hier résonnent dans le présent. Celui qui écoute peut en transformer la trame."},
    {name:"PRÉSENT",             quote:"Tout converge en un seul instant immobile. C’est là que s’ouvre la porte de tous les temps."},
    {name:"MÉMOIRE CELLULAIRE",  quote:"Chaque cellule conserve la trace du vivant. Le corps est une bibliothèque où rien ne se perd."},
    {name:"MÉMOIRE COLLECTIVE",  quote:"Le groupe rêve à travers l’individu. Dans la conscience partagée se tisse un monde commun."},
    {name:"LE TORE",             quote:"Le tore relie l’ombre et la lumière. De son cœur pulse la danse éternelle des cycles."}
  ]
  };
</script>

<script>
(function () {
  const STEPS_TORE = [
    { key: 'emotions',      label: 'ÉMOTIONS',       chip: 'Émotion',         pos: 0 },
    { key: 'besoins',       label: 'BESOINS',        chip: 'Besoin',          pos: 1 },
    { key: 'transmutation', label: 'TRANSMUTATION',  chip: 'Transmutation',   pos: 2 },
    { key: 'actions',       label: 'ACTIONS',        chip: 'Action',          pos: 3 },
    { key: 'archetypes',    label: 'ARCHÉTYPE',      chip: 'Archétype',       pos: 4 },
    { key: 'revelations',   label: 'RÉVÉLATION',     chip: 'Révélation',      pos: 5 },
    { key: 'cosmos',        label: 'MÉMOIRE COSMOS', chip: 'Mémoire Cosmos',  pos: 6 }
  ];

  const $  = s => document.querySelector(s);
  const el = id => document.getElementById(id);

  const section   = el('tore-immersif');
  if (!section) return;

  const intro     = el('tore-intro');
  const form      = el('tore-form');
  const boardWrap = el('tore-board');
  const boardHost = boardWrap?.querySelector('.tore-board-7');
  const results   = el('tore-results');
  const startBtn  = el('tore-start');
  const exitBtn   = el('exitToreBtn');

  // --- helper pour piocher une carte depuis window.DATA ---
  function pickFromData(familyKey) {
    const pool = Array.isArray(window.DATA?.[familyKey]) ? window.DATA[familyKey] : [];
    if (!pool.length) return null;
    const idx = Math.floor(Math.random() * pool.length);
    return pool[idx] || null;
  }

  function enterImmersiveTore () {
    document.body.classList.add('hide-immersive-tore');
    exitBtn.classList.remove('hidden');
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }

  function exitImmersiveTore () {
    document.body.classList.remove('hide-immersive-tore');
    exitBtn.classList.add('hidden');

    // reset
    intro.classList.remove('hidden');
    form.classList.add('hidden');
    boardWrap.classList.add('hidden');
    if (boardHost) boardHost.innerHTML = '';
    results.classList.add('hidden');
    results.innerHTML = '';
  }

  function buildBoardTore () {
    if (!boardHost) return;

    boardHost.innerHTML = STEPS_TORE.map(s => `
      <article class="tore-card pos-${s.pos}"
               data-family="${s.key}"
               aria-label="Carte ${s.label}">
        <div class="tore-card-inner">
          <div class="tore-card-back back" role="button" tabindex="0"
               aria-pressed="false" aria-label="Retourner la carte">
            <div class="logo-circle">TORE</div>
          </div>
          <div class="tore-card-front">
            <div class="topbar">
              <span class="chip">${s.chip}</span>
              <span class="polarity" data-polarity></span>
            </div>
            <div class="art">
              <div>
                <h3 data-name>—</h3>
                <p data-quote>—</p>
              </div>
            </div>
            <div class="bottom text-xs opacity-80 mt-2"></div>
          </div>
        </div>
      </article>
    `).join('');

    boardWrap.classList.remove('hidden');

    // comportement : au clic, on PIQUE une carte dans window.DATA et on la affiche
    boardHost.querySelectorAll('.tore-card .tore-card-back')
      .forEach(back => {
        back.addEventListener('click', () => {
          const card = back.closest('.tore-card');
          if (!card || card.classList.contains('flipped')) return;

          const famKey   = card.dataset.family;
          const data     = pickFromData(famKey);
          const nameEl   = card.querySelector('[data-name]');
          const quoteEl  = card.querySelector('[data-quote]');
          const polEl    = card.querySelector('[data-polarity]');
          const bottomEl = card.querySelector('.bottom');

          if (data) {
            nameEl.textContent  = data.name  || 'Carte';
            quoteEl.textContent = data.quote || '';
            if (bottomEl) bottomEl.textContent = data.bridge || '';

            // polarité : triangle / rond sauf pour cosmos
            if (famKey !== 'cosmos' && data.polarity) {
              polEl.textContent = data.polarity === 'yang' ? '▲' : '●';
              polEl.style.visibility = 'visible';
            } else {
              polEl.textContent = '';
              polEl.style.visibility = 'hidden';
            }
          } else {
            // aucun DATA trouvé → message de secours
            nameEl.textContent  = 'Aucune carte trouvée';
            quoteEl.textContent = 'Aucune donnée disponible pour cette famille.';
            if (bottomEl) bottomEl.textContent = '';
            polEl.style.visibility = 'hidden';
          }

          card.classList.add('flipped');
        });
      });
  }

  // --- listeners ---

  // intro -> formulaire
  startBtn?.addEventListener('click', () => {
    intro.classList.add('hidden');
    form.classList.remove('hidden');
  });

  // formulaire -> plateau + mode immersif
  form?.addEventListener('submit', (e) => {
    e.preventDefault();
    form.classList.add('hidden');
    buildBoardTore();
    enterImmersiveTore();
    results.classList.add('hidden'); // DeepSite pourra remplir plus tard
  });

  exitBtn?.addEventListener('click', exitImmersiveTore);
})();
</script>


<footer class="mt-16 border-t border-[rgba(212,175,55,.25)]">
  <div class="container mx-auto px-6 py-6 text-center text-xs text-light-gold/70">
    © Oradia – Tirage du Tore
  </div>
  
</footer>
  <script>
  const mobileBtn = document.getElementById("mobileMenuBtn");
  const mobileMenu = document.getElementById("mobileMenu");

  if (mobileBtn && mobileMenu) {
    mobileBtn.addEventListener("click", () => {
      mobileMenu.classList.toggle("hidden");
    });
  }
</script>
<script>
document.addEventListener("DOMContentLoaded", () => {

  // MENU MOBILE
  const mobileBtn = document.getElementById("mobileMenuBtn");
  const mobileMenu = document.getElementById("mobileMenu");

  if (mobileBtn) {
    mobileBtn.addEventListener("click", () => {
      mobileMenu.classList.toggle("hidden");
    });
  }

  // MENU ESPACE MEMBRE
  const btn = document.getElementById("memberMenuBtn");
  const menu = document.getElementById("memberDropdown");

  if (btn && menu) {
    btn.addEventListener("click", () => {
      menu.classList.toggle("hidden");
    });

    document.addEventListener("click", (e) => {
      if (!btn.contains(e.target) && !menu.contains(e.target)) {
        menu.classList.add("hidden");
      }
    });
  }

});
</script>

</body>
</html>
