<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=5" />
  <title>Oradia – Tirage du Tore</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'night-blue': '#0a192f',
            'gold': '#d4af37',
            'light-gold': '#f5e7a1',
            'dark-blue': '#051428',
            'celtic-blue': '#1a365d'
          },
          fontFamily: {
            'cormorant': ['Cormorant Garamond', 'serif'],
            'poppins': ['Poppins', 'sans-serif']
          }
        }
      }
    }
  </script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600;700&family=Poppins:wght@300;400;500;600&display=swap');

    :root {
      --dore:#d4af37;
      --text:#e9e7df;
    }

    body {
      margin:0;
      font-family:'Poppins',sans-serif;
      background:#0a192f;
      color:#f5e7a1;
    }

    .cormorant { font-family:'Cormorant Garamond', serif; }
    .bg-night-blue { background-color:#0a192f; }
    .text-gold { color:#d4af37; }
    .text-light-gold { color:#f5e7a1; }

    .btn-gold {
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding:0.75rem 1.5rem;
      border-radius:9999px;
      background:linear-gradient(90deg,#d4af37,#f5e7a1,#d4af37);
      background-size:200% 200%;
      color:#051428;
      font-weight:600;
      font-size:0.95rem;
      box-shadow:0 10px 30px rgba(0,0,0,.45);
      border:none;
      cursor:pointer;
      transition:transform .2s, box-shadow .2s, background-position .4s;
      text-decoration:none;
    }
    .btn-gold:hover {
      transform:translateY(-1px);
      box-shadow:0 15px 40px rgba(0,0,0,.6);
      background-position:100% 0;
    }

    .gold-gradient {
      background:linear-gradient(90deg,#d4af37,#f5e7a1,#d4af37);
      -webkit-background-clip:text;
      background-clip:text;
      color:transparent;
    }

    .container {
      max-width:1200px;
      margin:0 auto;
    }
  </style>
</head>
<body class="bg-night-blue text-light-gold">
<header class="border-b border-[rgba(212,175,55,.3)] bg-[rgba(5,20,40,.9)]">
  <div class="container mx-auto flex items-center justify-between px-6 py-4">
    <div class="flex items-center gap-3">
      <div class="w-10 h-10 rounded-full border border-gold flex items-center justify-center">
        <span class="text-gold font-bold tracking-[0.2em] text-xs">OR</span>
      </div>
      <span class="font-semibold tracking-[0.25em] uppercase text-xs text-light-gold">ORADIA</span>
    </div>
    <a href="index23.html" class="text-sm text-light-gold hover:text-gold transition">
      <i class="fas fa-arrow-left mr-2"></i>Retour au site
    </a>
  </div>
</header>

<!-- ================== TIRAGE DU TORE – PAGE IMMERSIVE ================== -->

<style>
  /* Mode immersif : on cache le reste quand le tirage est lancé */
  body.hide-immersive-tore > header,
  body.hide-immersive-tore > footer,
  body.hide-immersive-tore > section:not(#tore-immersif) {
    display: none !important;
  }

  /* Plateau 7 tas façon photo "Six-Points" */
  #tore-immersif .tore-board-7 {
    display: grid;
    grid-template-columns: repeat(3, minmax(0,1fr));
    grid-template-rows: repeat(3, auto);
    gap: 16px;
    place-items: center;
    max-width: 1200px;
    margin: 0 auto;
  }

  /* Disposition des piles :
     Ligne 1 : Révélation (gauche)          [pos-5]
               (rien au centre)
               Action (droite)             [pos-3]
     Ligne 2 : Transmutation (gauche)      [pos-2]
               Mémoire Cosmos (centre)     [pos-6]
               Archétype (droite)          [pos-4]
     Ligne 3 : Émotions (gauche)           [pos-0]
               (rien au centre)
               Besoin (droite)             [pos-1]
  */
  #tore-immersif .tore-board-7 .pos-5 { grid-area: 1 / 1; }
  #tore-immersif .tore-board-7 .pos-3 { grid-area: 1 / 3; }

  #tore-immersif .tore-board-7 .pos-2 { grid-area: 2 / 1; }
  #tore-immersif .tore-board-7 .pos-6 { grid-area: 2 / 2; }
  #tore-immersif .tore-board-7 .pos-4 { grid-area: 2 / 3; }

  #tore-immersif .tore-board-7 .pos-0 { grid-area: 3 / 1; }
  #tore-immersif .tore-board-7 .pos-1 { grid-area: 3 / 3; }

  /* Cartes du TORE (structure proche de la Traversée) */
  .tore-card {
    width: min(260px, 80vw);
    height: 380px;
    perspective: 1000px;
    position: relative;
  }

  @media (max-width: 860px) {
    #tore-immersif .tore-board-7 {
      grid-template-columns: 1fr;
      grid-template-rows: auto;
    }
    #tore-immersif .tore-board-7 .pos-0,
    #tore-immersif .tore-board-7 .pos-1,
    #tore-immersif .tore-board-7 .pos-2,
    #tore-immersif .tore-board-7 .pos-3,
    #tore-immersif .tore-board-7 .pos-4,
    #tore-immersif .tore-board-7 .pos-5,
    #tore-immersif .tore-board-7 .pos-6 {
      grid-area: auto;
    }
  }

  .tore-card-inner {
    position: relative;
    width: 100%;
    height: 100%;
    transform-style: preserve-3d;
    transition: transform 800ms cubic-bezier(.2,65,2,1), box-shadow .3s;
    border-radius: 18px;
    box-shadow: 0 20px 40px rgba(0,0,0,45);
  }
  .tore-card.flipped .tore-card-inner {
    transform: rotateY(180deg);
  }

  .tore-card-back,
  .tore-card-front {
    position: absolute;
    inset: 0;
    backface-visibility: hidden;
    border-radius: 18px;
    overflow: hidden;
    border: 1px solid rgba(212,175,55,45);
  }

  .tore-card-back {
    background: radial-gradient(circle at 20% 0%, rgba(245,231,161,15), transparent 55%),
                radial-gradient(circle at 80% 100%, rgba(88,190,255,12), transparent 55%),
                linear-gradient(160deg,#050b18,#08152b,#050b18);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
  }
  .tore-card-back .logo-circle {
    border-radius: 999px;
    padding: 10px 24px;
    border: 1px solid rgba(212,175,55,6);
    color: #f5e7a1;
    letter-spacing: .18em;
    text-transform: uppercase;
    font-size: .8rem;
  }

  .tore-card-front {
    transform: rotateY(180deg);
    background: radial-gradient(circle at 20% 0%, rgba(245,231,161,15), transparent 55%),
                radial-gradient(circle at 80% 100%, rgba(88,190,255,12), transparent 55%),
                linear-gradient(160deg,#071426,#020814,#050b18);
    display: flex;
    flex-direction: column;
    padding: 16px 18px;
    color: #f9f7ef;
  }
  .tore-card-front .topbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: .8rem;
    margin-bottom: 12px;
  }
  .tore-card-front .chip {
    border-radius: 999px;
    border: 1px solid rgba(212,175,55,75);
    padding: 4px 10px;
    text-transform: uppercase;
    font-weight: 600;
    letter-spacing: .14em;
    font-size: .72rem;
  }
  .tore-card-front .polarity {
    font-size: 1.1rem;
  }
  .tore-card-front .art {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    padding: 0 6px;
  }
  .tore-card-front [data-name] {
    font-family: "Cormorant Garamond", serif;
    font-size: 1.6rem;
    margin-bottom: .3rem;
  }
  .tore-card-front [data-quote] {
    font-size: .93rem;
    line-height: 1.4;
    opacity: .9;
  }
</style>

<section id="tore-immersif" class="py-20 px-6 bg-night-blue">
  <div class="container mx-auto max-w-6xl">
    <div class="text-center mb-12">
      <h1 class="cormorant text-4xl md:text-5xl font-bold mb-4 gold-gradient pb-1">
        Tirage du TORE
      </h1>
      <p class="text-light-gold max-w-3xl mx-auto">
        Guidance vibratoire complète – 7 familles, toutes les dimensions de votre être.
      </p>
    </div>

    <div class="rounded-2xl p-8 mb-8 relative overflow-hidden"
         style="background:linear-gradient(145deg,rgba(26,54,93,.8),rgba(5,20,40,.9));border:1px solid rgba(212,175,55,.3)">

      <!-- Bouton retour mode immersif -->
      <button id="exitToreBtn"
              class="fixed top-4 left-4 hidden z-50 bg-gold text-night-blue font-bold px-4 py-2 rounded-lg shadow-lg">
        <i class="fas fa-arrow-left mr-2"></i>Quitter le tirage
      </button>

      <!-- INTRO -->
      <div id="tore-intro" class="relative z-10">
        <h2 class="cormorant text-2xl text-gold mb-4">Préparation du tirage du TORE</h2>
        <p class="text-light-gold mb-6">
          Ce tirage complet explore les 7 familles de ton oracle. Nous avons besoin de quelques informations
          pour calibrer l’expérience.
        </p>
        <button id="tore-start" class="btn-gold">Commencer le tirage</button>
      </div>

      <!-- FORMULAIRE AVANT LE PLATEAU -->
      <form id="tore-form" class="hidden relative z-10 mt-6">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
          <div>
            <label class="block text-light-gold mb-2">Prénom</label>
            <input type="text" name="prenom"
                   class="w-full bg-[rgba(5,20,40,7)] border border-[rgba(212,175,55,35)] p-3 rounded-lg"
                   required>
          </div>
          <div>
            <label class="block text-light-gold mb-2">Date de naissance</label>
            <input type="date" name="date"
                   class="w-full bg-[rgba(5,20,40,7)] border border-[rgba(212,175,55,35)] p-3 rounded-lg"
                   required>
          </div>
          <div>
            <label class="block text-light-gold mb-2">Ville de naissance</label>
            <input type="text" name="ville"
                   class="w-full bg-[rgba(5,20,40,7)] border border-[rgba(212,175,55,35)] p-3 rounded-lg"
                   required>
          </div>
          <div>
            <label class="block text-light-gold mb-2">Heure de naissance</label>
            <input type="time" name="heure"
                   class="w-full bg-[rgba(5,20,40,7)] border border-[rgba(212,175,55,35)] p-3 rounded-lg"
                   required>
          </div>
        </div>
        <div class="mb-6">
          <label class="block text-light-gold mb-2">Votre intention pour ce tirage complet</label>
          <textarea name="intention"
                    class="w-full bg-[rgba(5,20,40,7)] border border-[rgba(212,175,55,35)] p-3 rounded-lg min-h-[120px]"
                    required></textarea>
        </div>
        <button type="submit" class="btn-gold w-full">Lancer le tirage du TORE</button>
      </form>

      <!-- PLATEAU – 7 TAS EN MODE SIX-POINTS -->
      <div id="tore-board" class="hidden relative z-10 mt-10">
        <h3 class="cormorant text-2xl text-gold mb-6 text-center">
          Retournez les 7 cartes du Tore
        </h3>
        <div class="tore-board-7">
          <!-- Les cartes sont générées par le script ci-dessous -->
        </div>
      </div>

      <!-- RÉSULTATS TEXTE -->
      <div id="tore-results" class="hidden relative z-10 mt-10">
        <!-- DeepSite peut injecter ici le rendu détaillé (texte, synthèse, etc.) -->
      </div>
    </div>
  </div>
</section>

<script>
(function () {
  const STEPS_TORE = [
    { key: 'emotions',      label: 'ÉMOTIONS',       chip: 'Émotion',         pos: 0 },
    { key: 'besoins',       label: 'BESOINS',        chip: 'Besoin',          pos: 1 },
    { key: 'transmutation', label: 'TRANSMUTATION',  chip: 'Transmutation',   pos: 2 },
    { key: 'actions',       label: 'ACTIONS',        chip: 'Action',          pos: 3 },
    { key: 'archetypes',    label: 'ARCHÉTYPE',      chip: 'Archétype',       pos: 4 },
    { key: 'revelations',   label: 'RÉVÉLATION',     chip: 'Révélation',      pos: 5 },
    { key: 'cosmos',        label: 'MÉMOIRE COSMOS', chip: 'Mémoire Cosmos',  pos: 6 }
  ];

  const $  = s => document.querySelector(s);
  const el = id => document.getElementById(id);

  const section   = el('tore-immersif');
  if (!section) return;

  const intro     = el('tore-intro');
  const form      = el('tore-form');
  const boardWrap = el('tore-board');
  const boardHost = boardWrap?.querySelector('.tore-board-7');
  const results   = el('tore-results');
  const startBtn  = el('tore-start');
  const exitBtn   = el('exitToreBtn');

  function enterImmersiveTore () {
    document.body.classList.add('hide-immersive-tore');
    exitBtn.classList.remove('hidden');
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }
  function exitImmersiveTore () {
    document.body.classList.remove('hide-immersive-tore');
    exitBtn.classList.add('hidden');
    // reset léger – libre à DeepSite de faire plus
    intro.classList.remove('hidden');
    form.classList.add('hidden');
    boardWrap.classList.add('hidden');
    if (boardHost) boardHost.innerHTML = '';
    results.classList.add('hidden');
    results.innerHTML = '';
  }

  function buildBoardTore () {
    if (!boardHost) return;

    boardHost.innerHTML = STEPS_TORE.map(s => `
      <article class="tore-card pos-${s.pos}"
               data-family="${s.key}"
               aria-label="Carte ${s.label}">
        <div class="tore-card-inner">
          <div class="tore-card-back back" role="button" tabindex="0"
               aria-pressed="false" aria-label="Retourner la carte">
            <div class="logo-circle">TORE</div>
          </div>
          <div class="tore-card-front">
            <div class="topbar">
              <span class="chip">${s.chip}</span>
              <span class="polarity" data-polarity></span>
            </div>
            <div class="art">
              <div>
                <h3 data-name>—</h3>
                <p data-quote>—</p>
              </div>
            </div>
            <div class="bottom"></div>
          </div>
        </div>
      </article>
    `).join('');

    boardWrap.classList.remove('hidden');

    // comportement de base : flip au clic
    boardHost.querySelectorAll('.tore-card .tore-card-back')
      .forEach(back => {
        back.addEventListener('click', () => {
          const card = back.closest('.tore-card');
          card.classList.add('flipped');
        });
      });
  }

  // listeners
  startBtn?.addEventListener('click', () => {
    intro.classList.add('hidden');
    form.classList.remove('hidden');
  });

  form?.addEventListener('submit', (e) => {
    e.preventDefault();
    form.classList.add('hidden');
    enterImmersiveTore();
    buildBoardTore();
    results.classList.add('hidden'); // à remplir après appel API
  });

  exitBtn?.addEventListener('click', exitImmersiveTore);
})();
</script>

<footer class="mt-16 border-t border-[rgba(212,175,55,.25)]">
  <div class="container mx-auto px-6 py-6 text-center text-xs text-light-gold/70">
    © Oradia – Tirage du Tore
  </div>
</footer>
</body>
</html>
